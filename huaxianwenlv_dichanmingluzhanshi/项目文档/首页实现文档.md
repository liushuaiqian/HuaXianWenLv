# 首页（/）实现文档

## 1. 页面功能描述

首页是整个文旅展示系统的门户页面，主要功能包括：

- **英雄横幅**：视频背景或大图展示，支持静音自动播放
- **文化亮点卡片**：展示3-6个核心文化亮点，链接到对应详情页
- **精选非遗滑动列表**：横向滚动展示精选非遗项目
- **精选视频与图集**：可预览或打开详情页的媒体内容
- **导航入口**：快速访问各个功能模块

## 2. 核心实现逻辑

### 2.1 数据获取
```javascript
// 从多个数据源获取首页展示内容
const loadHomeData = async () => {
  const [heritage, customs, media] = await Promise.all([
    fetch('/data/heritage.json').then(res => res.json()),
    fetch('/data/customs.json').then(res => res.json()),
    fetch('/data/media.json').then(res => res.json())
  ])
  
  // 筛选精选内容（标记为featured或按规则筛选）
  const featuredHeritage = heritage.filter(item => item.featured || heritage.indexOf(item) < 6)
  const featuredMedia = media.filter(item => item.type === 'image').slice(0, 8)
  
  return { featuredHeritage, featuredMedia, totalCounts: { heritage: heritage.length, customs: customs.length } }
}
```

### 2.2 英雄区域视频处理
```javascript
// 视频自动播放处理（浏览器策略限制）
const handleHeroVideo = () => {
  const video = videoRef.value
  if (video) {
    video.muted = true // 必须静音才能自动播放
    video.play().catch(err => {
      console.log('Auto-play failed:', err)
      // 回退为显示封面图
      showVideoPoster.value = true
    })
  }
}
```

### 2.3 懒加载与性能优化
```javascript
// 使用 IntersectionObserver 实现懒加载
const useIntersectionObserver = (target, callback) => {
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        callback(entry.target)
        observer.unobserve(entry.target)
      }
    })
  }, { threshold: 0.1 })
  
  if (target.value) observer.observe(target.value)
  
  onUnmounted(() => observer.disconnect())
}
```

## 3. 关键代码片段

### 3.1 Vue组件结构
```vue
<template>
  <div class="home-page">
    <!-- 英雄区域 -->
    <section class="hero-section relative h-screen">
      <video 
        ref="videoRef"
        class="w-full h-full object-cover"
        :poster="heroData.poster"
        muted
        loop
        @loadeddata="handleHeroVideo"
      >
        <source :src="heroData.videoSrc" type="video/mp4">
      </video>
      
      <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center">
        <div class="text-center text-white">
          <h1 class="text-6xl font-bold mb-4">{{ heroData.title }}</h1>
          <p class="text-xl mb-8">{{ heroData.subtitle }}</p>
          <button 
            @click="scrollToContent"
            class="bg-primary text-white px-8 py-3 rounded-lg hover:bg-primary-dark transition"
          >
            探索文化
          </button>
        </div>
      </div>
    </section>

    <!-- 文化亮点 -->
    <section class="cultural-highlights py-16">
      <div class="container mx-auto px-4">
        <h2 class="text-4xl font-bold text-center mb-12">文化亮点</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          <HighlightCard 
            v-for="highlight in highlights" 
            :key="highlight.id"
            :data="highlight"
            @click="navigateToDetail(highlight)"
          />
        </div>
      </div>
    </section>

    <!-- 精选非遗 -->
    <section class="featured-heritage py-16 bg-gray-50">
      <div class="container mx-auto px-4">
        <div class="flex justify-between items-center mb-8">
          <h2 class="text-4xl font-bold">精选非遗</h2>
          <router-link to="/heritage" class="text-primary hover:underline">
            查看全部 →
          </router-link>
        </div>
        
        <div class="overflow-x-auto">
          <div class="flex space-x-6 pb-4">
            <HeritageCard 
              v-for="item in featuredHeritage" 
              :key="item.id"
              :heritage="item"
              class="flex-shrink-0 w-80"
            />
          </div>
        </div>
      </div>
    </section>

    <!-- 精选媒体 -->
    <MediaGallery 
      :items="featuredMedia"
      :show-lightbox="true"
      class="py-16"
    />
  </div>
</template>
```

### 3.2 Composition API逻辑
```vue
<script setup>
import { ref, onMounted, onUnmounted } from 'vue'
import { useRouter } from 'vue-router'
import HighlightCard from '@/components/cards/HighlightCard.vue'
import HeritageCard from '@/components/cards/HeritageCard.vue'
import MediaGallery from '@/components/media/MediaGallery.vue'

const router = useRouter()
const videoRef = ref(null)
const showVideoPoster = ref(false)

// 数据状态
const heroData = ref({
  title: 'XX地方文化之旅',
  subtitle: '探索千年文化，传承非遗经典',
  videoSrc: '/media/hero/intro.mp4',
  poster: '/media/hero/poster.webp'
})

const highlights = ref([])
const featuredHeritage = ref([])
const featuredMedia = ref([])

// 页面初始化
onMounted(async () => {
  try {
    const homeData = await loadHomeData()
    featuredHeritage.value = homeData.featuredHeritage
    featuredMedia.value = homeData.featuredMedia
    
    // 设置文化亮点
    highlights.value = [
      { id: 'culture', title: '文化概况', description: '了解地方历史文化', icon: 'culture', link: '/culture' },
      { id: 'heritage', title: '非遗传承', description: `${homeData.totalCounts.heritage}项非遗项目`, icon: 'heritage', link: '/heritage' },
      { id: 'customs', title: '民俗节庆', description: `${homeData.totalCounts.customs}个传统节庆`, icon: 'customs', link: '/customs' },
      { id: 'media', title: '影像库', description: '图文视频资料', icon: 'media', link: '/media' }
    ]
  } catch (error) {
    console.error('加载首页数据失败:', error)
  }
})

// 交互方法
const scrollToContent = () => {
  document.querySelector('.cultural-highlights').scrollIntoView({ 
    behavior: 'smooth' 
  })
}

const navigateToDetail = (highlight) => {
  router.push(highlight.link)
}
</script>
```

## 4. 依赖关系说明

### 4.1 组件依赖
- `HighlightCard.vue` - 文化亮点卡片组件
- `HeritageCard.vue` - 非遗项目卡片组件
- `MediaGallery.vue` - 媒体画廊组件

### 4.2 数据依赖
- `/public/data/heritage.json` - 非遗项目数据
- `/public/data/customs.json` - 风俗节庆数据
- `/public/data/media.json` - 媒体文件数据
- `/public/media/hero/` - 英雄区域媒体文件

### 4.3 样式依赖
- Tailwind CSS 基础样式类
- 主题色彩变量 (CSS Custom Properties)
- 响应式断点设置

## 5. 注意事项

### 5.1 性能优化
- 英雄视频应压缩至合理大小（建议<10MB）
- 使用 WebP 格式图片，提供 JPEG 回退
- 精选内容懒加载，避免首屏加载过多数据
- 视频播放失败时显示封面图作为回退

### 5.2 用户体验
- 英雄视频必须静音才能自动播放（浏览器策略）
- 提供视频播放控制按钮
- 确保在网络较慢时有合适的加载状态
- 移动端优化触摸滑动体验

### 5.3 SEO优化
```javascript
// 设置页面元信息
useSeoMeta({
  title: 'XX地方文旅展示 | 文化·风俗·非遗',
  description: 'XX地方文化概况与非遗精选展示，图文视频一站式浏览',
  ogTitle: 'XX地方文化之旅',
  ogDescription: '探索千年文化，传承非遗经典',
  ogImage: '/media/hero/og-image.webp'
})
```

### 5.4 可访问性
- 为所有图片提供有意义的 alt 文本
- 视频提供字幕文件支持
- 确保键盘导航可用
- 保持足够的色彩对比度

### 5.5 浏览器兼容性
- 现代浏览器（Chrome 80+, Firefox 75+, Safari 13+）
- 移动端 iOS Safari 13+, Android Chrome 80+
- 视频格式提供 MP4 H.264 编码