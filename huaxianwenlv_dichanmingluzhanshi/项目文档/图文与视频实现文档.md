# 图文与视频（/media, /media/:id）实现文档

## 1. 页面功能描述
- Tab 切换“图集 / 视频”
- 图集：瀑布流/网格，灯箱预览，键盘 ESC 退出
- 视频：播放器（控制条、倍速、字幕），懒加载
- 详情页（可选）：图/视频 + 描述 + 关联内容

## 2. 核心实现逻辑

### 2.1 Tab 与过滤
```vue
<template>
  <Tabs :items="['图集','视频']" v-model="active" />
  <div v-if="active==='图集'">
    <MasonryGallery :items="images" @open="openLightbox" />
  </div>
  <div v-else>
    <VideoList :items="videos" />
  </div>
</template>
```

### 2.2 灯箱与键盘可关闭
```javascript
const showLightbox = ref(false)
const currentIndex = ref(0)

const openLightbox = (idx) => { currentIndex.value = idx; showLightbox.value = true }

onMounted(() => {
  const onKey = (e) => {
    if (e.key === 'Escape') showLightbox.value = false
    if (e.key === 'ArrowRight') currentIndex.value = (currentIndex.value + 1) % images.value.length
    if (e.key === 'ArrowLeft') currentIndex.value = (currentIndex.value - 1 + images.value.length) % images.value.length
  }
  window.addEventListener('keydown', onKey)
  onUnmounted(() => window.removeEventListener('keydown', onKey))
})
```

### 2.3 视频播放器
```vue
<VideoPlayer 
  v-for="v in videos" :key="v.id"
  :src="v.src"
  :poster="v.poster"
  :subtitles="v.subtitles"
  :controls="true"
/>
```

## 3. 关键代码片段

```vue
<!-- MasonryGallery.vue -->
<template>
  <div class="columns-1 md:columns-2 lg:columns-3 gap-4">
    <figure v-for="(img,i) in items" :key="img.src" class="mb-4 cursor-zoom-in" @click="$emit('open', i)">
      <img :src="img.src" :alt="img.alt" class="w-full rounded-md" loading="lazy" />
      <figcaption class="text-sm text-gray-500 mt-1">{{ img.alt }}</figcaption>
    </figure>
  </div>
</template>
```

```vue
<!-- Lightbox.vue -->
<template>
  <div v-if="modelValue" class="fixed inset-0 bg-black/90 flex items-center justify-center">
    <button class="absolute top-4 right-4 text-white" @click="$emit('update:modelValue', false)">×</button>
    <img :src="current.src" :alt="current.alt" class="max-h-[90vh] max-w-[90vw]" />
  </div>
</template>
```

## 4. 依赖关系说明
- 数据：/public/data/media.json
- 组件：Tabs、MasonryGallery、Lightbox、VideoPlayer
- 库：可选 plyr.js（增强播放器）、IntersectionObserver（懒加载）

## 5. 注意事项
- 图片优先 WebP，提供回退；视频提供 poster 与 VTT 字幕
- 灯箱支持键盘导航与 ESC 关闭
- 性能：分页或懒加载，首屏控制加载量
- SEO：详情页设置 title/description，媒体提供 alt 与可读标题